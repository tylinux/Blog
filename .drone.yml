kind: pipeline
name: build && publish

steps:
- name: update theme
  image: alpine/git
  commands:
    - git submodule update --recursive --init

- name: generate
  image: plugins/hugo
  settings:
    hugo_version: 0.79.0
    validate: true
  commands:
    - hugo

- name: deploy
  image: appleboy/drone-scp
  settings:
    host:
      - tylinux.com
    username: tylinux
    port: 22
    key: 
      from_secret: deploy_key
    source:
      - public
    target:
      - /home/tylinux/docker/nginx/